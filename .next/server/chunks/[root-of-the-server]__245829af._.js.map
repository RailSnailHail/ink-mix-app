{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 6, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"","debugId":null}},
    {"offset": {"line": 60, "column": 0}, "map": {"version":3,"sources":["file:///home/jim/ink-mix-app/src/app/api/inventory/deduct/route.ts"],"sourcesContent":["import { NextResponse } from 'next/server';\nimport prisma from '@/lib/prisma';\n\n// This interface defines the shape of the data we expect\ninterface DeductRequest {\n  components: {\n    inkId: number;\n    grams: number;\n  }[];\n}\n\nexport async function POST(request: Request) {\n  try {\n    const body: DeductRequest = await request.json();\n    const { components } = body;\n\n    if (!components || components.length === 0) {\n      return NextResponse.json({ error: 'No components to deduct' }, { status: 400 });\n    }\n\n    // Use a transaction to ensure all deductions succeed or none do\n    await prisma.$transaction(async (tx) => {\n      for (const component of components) {\n        await tx.ink.update({\n          where: { id: component.inkId },\n          data: { stockG: { decrement: component.grams } },\n        });\n      }\n    });\n\n    return NextResponse.json({ success: true }, { status: 200 });\n\n  } catch (error) {\n    console.error(\"API Error deducting inventory:\", error);\n    return NextResponse.json({ error: 'Failed to deduct inventory' }, { status: 500 });\n  }\n}"],"names":[],"mappings":";;;AAAA;;;;;;;;AAWO,eAAe,KAAK,OAAgB;IACzC,IAAI;QACF,MAAM,OAAsB,MAAM,QAAQ,IAAI;QAC9C,MAAM,EAAE,UAAU,EAAE,GAAG;QAEvB,IAAI,CAAC,cAAc,WAAW,MAAM,KAAK,GAAG;YAC1C,OAAO,+PAAA,CAAA,eAAY,CAAC,IAAI,CAAC;gBAAE,OAAO;YAA0B,GAAG;gBAAE,QAAQ;YAAI;QAC/E;QAEA,gEAAgE;QAChE,MAAM,OAAO,YAAY,CAAC,OAAO;YAC/B,KAAK,MAAM,aAAa,WAAY;gBAClC,MAAM,GAAG,GAAG,CAAC,MAAM,CAAC;oBAClB,OAAO;wBAAE,IAAI,UAAU,KAAK;oBAAC;oBAC7B,MAAM;wBAAE,QAAQ;4BAAE,WAAW,UAAU,KAAK;wBAAC;oBAAE;gBACjD;YACF;QACF;QAEA,OAAO,+PAAA,CAAA,eAAY,CAAC,IAAI,CAAC;YAAE,SAAS;QAAK,GAAG;YAAE,QAAQ;QAAI;IAE5D,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,kCAAkC;QAChD,OAAO,+PAAA,CAAA,eAAY,CAAC,IAAI,CAAC;YAAE,OAAO;QAA6B,GAAG;YAAE,QAAQ;QAAI;IAClF;AACF","debugId":null}}]
}